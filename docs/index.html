<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fast and Memory-Efficient Annotation of Big Corpora • bignlp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Fast and Memory-Efficient Annotation of Big Corpora">
<meta property="og:description" content="Parallel line-by-line NLP processing for big corpora using Stanford CoreNLP.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">bignlp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/vignette.html">bignlp</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/PolMine/bignlp/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<div id="the-bignlp-package-objectives" class="section level2">
<h2 class="hasAnchor">
<a href="#the-bignlp-package-objectives" class="anchor"></a>The ‘bignlp’-package: Objectives</h2>
<p>R users who want to add a linguistic annotation to a corpus are already offered a few available packages for Natural Language Processing (NLP). These packages are not “pure R” NLP-tools. <a href="https://CRAN.R-project.org/package=openNLP">openNLP</a>, <a href="https://CRAN.R-project.org/package=cleanNLP">cleanNLP</a>, <a href="https://CRAN.R-project.org/package=coreNLP">coreNLP</a>, or <a href="https://CRAN.R-project.org/package=spacyr">spacyr</a> offer interfaces to standard NLP tools implemented in other programming languages. The <a href="https://CRAN.R-project.org/package=cleanNLP">cleanNLP</a> R package offers to combine these external tools in one coherent framework. So why yet another NLP R package?</p>
<p>As a matter of design, the existing packages are not good to deal with large volumes of text. The thrust of the bignlp-package is to use a standard tool (<a href="https://stanfordnlp.github.io/CoreNLP/">Stanford CoreNLP</a>) in parallel mode. To be parsimonious with the memory available, it implements line-by-line processing, so that annotated data is not be kept in memory. The bignlp is the package you may want to use if your data is substantially big.</p>
</div>
<div id="workflow" class="section level2">
<h2 class="hasAnchor">
<a href="#workflow" class="anchor"></a>Workflow</h2>
<p>There are three steps of the NLP pipeline using bignlp: Turn input data into tabular format, call the annotator that generates an NDJSON output, parse the NDJSON and get a tabular output format. To explain this in more detail:</p>
<ol>
<li><p>Input data (XML, for instance) needs to be dissected into a two-column <code>data.table</code> with one column with sections of text (column “text”) and a column “id”. The purpose of the id is to serve as a link to connect chunks with metadata that is stored somewhere else, typically in another table that also has an id column for matching purposes.</p></li>
<li><p>The input <code>data.table</code> is processed in single- or multi-threaded mode, using Stanford CoreNLP. The output of the <code><a href="reference/corenlp_annotate.html">corenlp_annotate()</a></code>-function is written to one or several NDJSON files (NDJSON stands for newline-delimited JSON). Each line of the NDJSON files is a valid JSON string with the annotation data, and includes the id.</p></li>
<li><p>The NDJSON files are processed a line-by-line manner, resulting in a <code>data.table</code> with the chunk ids, and the tokenized and annotated text using the <code>corenlp_parse_ndjson()</code>-function.</p></li>
</ol>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>The bignlp package itself is a pure R package. It does not include compiled code, and the installation of the package itself is unlikely to cause problem. However, bignlp depends on the <a href="https://stanfordnlp.github.io/CoreNLP/">Stanford CoreNLP</a> toolset, a Java library, which requires a specific Java version (1.8). CoreNLP is accessed using the <a href="https://CRAN.R-project.org/package=rJava">rJava</a> package. Both can cause headaches.</p>
<div id="oracle-java-required" class="section level3">
<h3 class="hasAnchor">
<a href="#oracle-java-required" class="anchor"></a>Oracle Java required!</h3>
<p>Stanford CoreNLP requires Oracle Java v1.8+, see <a href="https://stanfordnlp.github.io/CoreNLP/">the CoreNLP Website</a>. Using CoreNLP in combination with OpenJDK, the default Java that is available on many systems, does not work. Errors that result from using the “wrong” Java may be difficult to interpret. So take care to ensure that you have the “correct”" Java (Java Development Kit / JDK) installed.</p>
<p>Oracle Java can be installed from <a href="https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html">this website</a>. Note that Oracle licenses have become more restrictive, and registration may be necessary. This will not be a problem for academic/non-commercial contexts.</p>
<p>Once downloading and installing Oracle Java 1.8+ is completed, making this Java version the one that is actually used may be tricky. For macOS, we found the jEnv tool to be useful, see <a href="https://medium.com/@danielnenkov/multiple-jdk-versions-on-mac-os-x-with-jenv-5ea5522ddc9b">this link</a>.</p>
<p>To get R use Java 1.8, you may finalle have to call R CMD javareconf from the command line.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1"><span class="ex">R</span> CMD javareconf</a></code></pre></div>
<p>To check within R that everything works, run this snippet from within R.</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">rJava</span>)
<span class="fu"><a href="https://rdrr.io/pkg/rJava/man/jinit.html">.jinit</a></span>()
<span class="fu"><a href="https://rdrr.io/pkg/rJava/man/jcall.html">.jcall</a></span>(<span class="st">"java/lang/System"</span>, <span class="st">"S"</span>, <span class="st">"getProperty"</span>, <span class="st">"java.runtime.version"</span>)</pre></div>
<p>The output you see (something like “1.8.0_211-b12”) on your system depend on the Java version you have installed.</p>
</div>
<div id="issues-with-rjava" class="section level3">
<h3 class="hasAnchor">
<a href="#issues-with-rjava" class="anchor"></a>Issues with rJava</h3>
<p>An issue we have seen on macOS in combination with RStudio is that the rJava dynamic library called from the RStudio session does not link correctly agains the dynamic library of the Java virtual machine. We use the follwing snippet to induce the correct link. (Note that paths may have to be updated to reflect the correct R and Java version!)</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" title="1"><span class="ex">install_name_tool</span> -change <span class="st">"@rpath/libjvm.dylib"</span> \</a>
<a class="sourceLine" id="cb3-2" title="2">  <span class="st">"/Library/Java/JavaVirtualMachines/jdk1.8.0_211.jdk/Contents/Home/jre/lib/server/libjvm.dylib"</span> \</a>
<a class="sourceLine" id="cb3-3" title="3">  /Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so</a></code></pre></div>
</div>
<div id="issues-with-rstudio" class="section level3">
<h3 class="hasAnchor">
<a href="#issues-with-rstudio" class="anchor"></a>Issues with RStudio</h3>
<p>We have seen problems with the parallel annotation with from an RStudio session. Running bignlp from a simple terminal window is a good solution. For a large annotation project, omitting an IDE may be a good idea anyway.</p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/PolMine/bignlp/">https://​github.com/​PolMine/​bignlp/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/PolMine/bignlp/issues">https://​github.com/​PolMine/​bignlp/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Andreas Blaette <br><small class="roles"> Author, maintainer </small>  </li>
<li>Christoph Leonhardt <br><small class="roles"> Author </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.gnu.org/licenses/gpl-3.0"><img src="https://img.shields.io/badge/License-GPLv3-blue.svg" alt="License: GPL v3"></a></li>
<li><a href="https://github.com/PolMine/bignlp/actions"><img src="https://github.com/PolMine/bignlp/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://codecov.io/gh/PolMine/bignlp/branch/master"><img src="https://codecov.io/gh/PolMine/bignlp/branch/master/graph/badge.svg" alt="codecov"></a></li>
<li><a href="https://www.repostatus.org/#active"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://www.tidyverse.org/lifecycle/#maturing"><img src="https://img.shields.io/badge/lifecycle-maturing-blue.svg" alt="Lifecycle: maturing"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Andreas Blaette, Christoph Leonhardt.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
